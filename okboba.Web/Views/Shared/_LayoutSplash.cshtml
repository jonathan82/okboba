@using okboba.Resources;

<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>@ViewBag.Title</title>

    @Styles.Render("~/bundles/css/all")

    <style>
        @@media (max-width: 800px) {
            .body-splash {
                background-image: none;
            }
            .splash-buffer {
                display: none;
            }
            .splash-container {
                position: relative;
                background-color: #FCE4EC;
            }
            .splash-container .container {
                padding-top: 0;
            }
        }
    </style>
</head>

<body class="body-splash">

    <!-- Matches the size of the background image -->
    <div class="splash-buffer"></div>

    <div class="splash-container">

        <!-- Navbar -->
        <div class="splash-navbar">
            <button class="btn btn-primary login-button" data-toggle="modal" data-target="#loginModal">@i18n.Common_Login</button>
        </div>

        <!-- Registration form -->
        <div class="container">
            @RenderBody()
        </div>

    </div>

    @Html.Partial("_Login")

    @Html.Partial("_Marketing")


    @Scripts.Render("~/bundles/js/vendor")
    @Scripts.Render("~/bundles/js/okboba")
    @RenderSection("scripts", required: false)

    <footer style="padding-top: 100px;">
        <span class="text-info">&copy; @DateTime.Now.Year - Okboba.com</span>
    </footer>

    <script>
        function LoginSuccess() {
            //load return url
            //alert('login success');
            window.location.replace('/home');
        }

        //Validation options for login form
        var opt = {
            rules: {
                Email: "required",
                Password: "required"
            },

            submitHandler: function (form) {
                var validator = this;
                validator.resetForm();
                $(form).find('button[type="submit"]').prop("disabled", true);
                $.post('/account/login', $(form).serialize(), LoginSuccess)
                    .fail(function () {
                        //show login error
                        //alert('login error');
                        validator.showErrors({ "Password": "@i18n.Login_BadPassword" });
                        $(form).find('button[type="submit"]').prop("disabled", false);
                    });
            }
        }

        $('#loginForm').validate(opt);
    </script>

</body>
</html>
